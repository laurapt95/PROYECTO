 ## /ajax

Scripts que responden a peticiones **AJAX** del cliente. Devuelven datos en formato JSON para los formularios din√°micos y el mapa.

| Archivo                   | Descripci√≥n                                                                 |
|---------------------------|-----------------------------------------------------------------------------|
| `fill_location.php`       | Reconstruye toda la cadena de ubicaci√≥n a partir de un `id_localidad`.     |
| `get_eventos_json.php`    | Devuelve eventos p√∫blicos con coordenadas (para el mapa de Leaflet.js).    |
| `get_ccaa.php`            | Devuelve las CCAA seg√∫n el pa√≠s.                                           |
| `get_municipios.php`      | Devuelve municipios seg√∫n provincia.                                       |
| `get_localidades.php`     | Devuelve localidades seg√∫n municipio seleccionado.                         |

---

## /shortcodes

Contiene scripts PHP que se registran como **shortcodes** en WordPress, permitiendo insertar funcionalidades en p√°ginas sin tocar el tema.

| Archivo                          | Funcionalidad principal                                                      |
|----------------------------------|------------------------------------------------------------------------------|
| `buscar_eventos_mapa.php`        | Muestra todos los eventos futuros en un mapa interactivo (Leaflet.js).      |
| `configurar_cuenta.php`          | Formulario para editar los datos del usuario (correo, contrase√±a, etc.).    |
| `contador_eventos.php`           | Muestra estad√≠sticas p√∫blicas por tipo de evento.                           |
| `formulario_registrar_evento.php`| Registro de eventos: ubicaci√≥n jer√°rquica + mapa + validaciones.            |
| `formulario_registro.php`        | Registro de nuevos usuarios. Verifica alias, correo y guarda el hash.       |
| `modificar_eventos_usuario.php`  | Editar o borrar eventos propios (solo los futuros).                         |
| `panel_bienvenida.php`           | Dashboard con resumen de votos, alias y accesos r√°pidos.                    |
| `votar_evento.php`               | Votar eventos pasados (estrellas y comentario opcional).                    |
| `verificar_login.php`            | Verifica sesi√≥n iniciada, si no, redirige a login.                          |

---

## üìÑ Archivos ra√≠z

| Archivo               | Funci√≥n                                                                                     |
|-----------------------|---------------------------------------------------------------------------------------------|
| `external-login.php`  | Archivo principal. Registra todos los shortcodes y funciones principales del plugin.        |
| `conexion.php`        | Maneja la conexi√≥n a la base de datos externa `eventosdb` mediante mysqli.                  |
| `login.php`           | Script de inicio de sesi√≥n. Verifica alias, password (hasheada) y lanza sesi√≥n.             |
| `cerrar_sesion.php`   | Destruye la sesi√≥n activa y redirige al formulario de inicio.                               |
| `README.txt`          | (Este mismo contenido o resumen).                                                           |

---

## Notas T√©cnicas

- El plugin no depende de la base de datos nativa de WordPress.
- Todos los formularios usan AJAX y JSON para una experiencia fluida y sin recarga.
- Las contrase√±as se almacenan cifradas con `password_hash()` (bcrypt).
- Se utiliza el usuario `preventuser` con permisos restringidos sobre la BBDD.

---

## Requisitos para funcionar

- Base de datos externa `eventosdb` con tablas relacionadas: usuarios, eventos, votaciones, localizaci√≥n.
- WordPress instalado en el servidor.
- Plugin activado en `/wp-content/plugins/external-login`.

---

## Dependencias externas

- API p√∫blica de OpenStreetMap (Nominatim) para asignaci√≥n de coordenadas.
- Leaflet.js para visualizaci√≥n de eventos en el mapa.

---

## Seguridad

- Toda la interacci√≥n con la base de datos pasa por `conexion.php`, evitando duplicaci√≥n de c√≥digo.
- Datos sensibles (como contrase√±as) no est√°n expuestos en texto plano.

---

## Cr√©ditos

Desarrollado por Laura Penedo Torino como parte del proyecto ASIR 2024-2025: ‚ÄúPreven-T: Aplicaci√≥n Web para la notificaci√≥n de eventos sonoros‚Äù.

---








  
